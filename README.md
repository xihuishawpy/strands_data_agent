# ChatBI - ä¼ä¸šçº§æ™ºèƒ½æ•°æ®æŸ¥è¯¢åº”ç”¨

åŸºäº Strands Agents æ¡†æ¶æ„å»ºçš„ä¼ä¸šçº§ ChatBI æ™ºèƒ½æ•°æ®æŸ¥è¯¢åº”ç”¨ï¼Œæ”¯æŒé€šè¿‡è‡ªç„¶è¯­è¨€æŸ¥è¯¢ PostgreSQLã€MySQL ç­‰æ•°æ®åº“ï¼Œè‡ªåŠ¨ç”Ÿæˆ SQLã€æ‰§è¡ŒæŸ¥è¯¢ã€æ•°æ®åˆ†æå’Œå¯è§†åŒ–ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **æ™ºèƒ½SQLç”Ÿæˆ**: å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºå‡†ç¡®çš„SQLæŸ¥è¯¢
- ğŸ”’ **å®‰å…¨æ‰§è¡Œ**: ä½¿ç”¨åªè¯»æƒé™ç¡®ä¿æ•°æ®å®‰å…¨
- ğŸ“Š **æ™ºèƒ½åˆ†æ**: AIé©±åŠ¨çš„æ•°æ®è§£è¯»å’Œæ´å¯Ÿ
- ğŸ“ˆ **æ•°æ®å¯è§†åŒ–**: è‡ªåŠ¨ç”Ÿæˆå›¾è¡¨å’Œå¯è§†åŒ–
- ğŸ¢ **ä¼ä¸šçº§**: æ”¯æŒå¤šæ•°æ®åº“ã€Schemaç®¡ç†ã€æƒé™æ§åˆ¶
- ğŸ”„ **å¤šæ™ºèƒ½ä½“åä½œ**: åŸºäº"æ™ºèƒ½ä½“å³å·¥å…·"æ¨¡å¼çš„æ¶æ„

## æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·æ¥å£       â”‚â”€â”€â”€â–¶â”‚   ä¸»æ§æ™ºèƒ½ä½“     â”‚â”€â”€â”€â–¶â”‚   æ•°æ®åº“è¿æ¥     â”‚
â”‚   (Web UI)      â”‚    â”‚ (Orchestrator)  â”‚    â”‚   (åªè¯»æƒé™)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®å¯è§†åŒ–å·¥å…·  â”‚â—€â”€â”€â”€â”‚  SQLç”Ÿæˆæ™ºèƒ½ä½“   â”‚â”€â”€â”€â–¶â”‚   SchemaçŸ¥è¯†åº“   â”‚
â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®åˆ†ææ™ºèƒ½ä½“  â”‚    â”‚   SQLæ‰§è¡Œå·¥å…·    â”‚
â”‚                â”‚    â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd strands_data_agent

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
cp config.env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ‚¨çš„æ•°æ®åº“è¿æ¥å’ŒAPIå¯†é’¥
```

### 2. æ•°æ®åº“é…ç½®

ç¡®ä¿æ‚¨çš„æ•°æ®åº“ç”¨æˆ·å…·æœ‰**åªè¯»æƒé™**ï¼š

```sql
-- PostgreSQL ç¤ºä¾‹
CREATE USER chatbi_readonly WITH PASSWORD 'secure_password';
GRANT CONNECT ON DATABASE your_database TO chatbi_readonly;
GRANT USAGE ON SCHEMA public TO chatbi_readonly;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO chatbi_readonly;
```

### 3. å¯åŠ¨åº”ç”¨

```bash
# å¯åŠ¨ Web API
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œæ¥å£
python cli.py "ä¸Šä¸ªæœˆé”€å”®é¢æœ€é«˜çš„äº§å“æ˜¯ä»€ä¹ˆï¼Ÿ"
```

### 4. ä½¿ç”¨ç¤ºä¾‹

```python
from chatbi import ChatBIOrchestrator

# åˆ›å»ºChatBIå®ä¾‹
chatbi = ChatBIOrchestrator()

# æŸ¥è¯¢ç¤ºä¾‹
result = chatbi.query("æ˜¾ç¤ºè¿‡å»6ä¸ªæœˆæ¯æœˆçš„é”€å”®è¶‹åŠ¿")
print(result)
```

## é¡¹ç›®ç»“æ„

```
strands_data_agent/
â”œâ”€â”€ app/                     # Webåº”ç”¨
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py             # FastAPIä¸»åº”ç”¨
â”‚   â”œâ”€â”€ api/                # APIè·¯ç”±
â”‚   â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ templates/          # å‰ç«¯æ¨¡æ¿
â”œâ”€â”€ chatbi/                 # æ ¸å¿ƒChatBIæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database/           # æ•°æ®åº“è¿æ¥å’Œå·¥å…·
â”‚   â”œâ”€â”€ agents/             # æ™ºèƒ½ä½“å®šä¹‰
â”‚   â”œâ”€â”€ tools/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ knowledge/          # çŸ¥è¯†åº“ç®¡ç†
â”‚   â””â”€â”€ orchestrator.py     # ä¸»æ§æ™ºèƒ½ä½“
â”œâ”€â”€ data/                   # æ•°æ®ç›®å½•
â”œâ”€â”€ logs/                   # æ—¥å¿—ç›®å½•
â”œâ”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ cli.py                  # å‘½ä»¤è¡Œæ¥å£
â”œâ”€â”€ requirements.txt        # ä¾èµ–æ–‡ä»¶
â””â”€â”€ README.md              # é¡¹ç›®æ–‡æ¡£
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **åªè¯»æƒé™**: ç¡®ä¿æ•°æ®åº“ç”¨æˆ·åªæœ‰SELECTæƒé™
2. **è¾“å…¥éªŒè¯**: æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯å’Œæ¸…ç†
3. **SQLæ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢å’Œå®‰å…¨æ£€æŸ¥
4. **è®¿é—®æ§åˆ¶**: å®ç°ç”¨æˆ·è®¤è¯å’Œæˆæƒæœºåˆ¶

## é…ç½®è¯´æ˜

è¯¦ç»†çš„é…ç½®é€‰é¡¹è¯·å‚è€ƒ `config.env.example` æ–‡ä»¶ã€‚

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„æ•°æ®åº“æ”¯æŒ

1. åœ¨ `chatbi/database/connectors.py` ä¸­æ·»åŠ æ–°çš„è¿æ¥å™¨
2. æ›´æ–° `chatbi/database/schema_manager.py` ä¸­çš„Schemaæå–é€»è¾‘
3. æµ‹è¯•è¿æ¥å’ŒæŸ¥è¯¢åŠŸèƒ½

### è‡ªå®šä¹‰æ™ºèƒ½ä½“

```python
from strands import Agent
from chatbi.agents.base import BaseAgent

class CustomAnalysisAgent(BaseAgent):
    def __init__(self):
        super().__init__(
            name="Custom_Analysis_Agent",
            system_prompt="æ‚¨çš„è‡ªå®šä¹‰ç³»ç»Ÿæç¤º..."
        )
```

## è®¸å¯è¯

[MIT License](LICENSE)

## è´¡çŒ®

æ¬¢è¿æäº¤ Issues å’Œ Pull Requestsï¼

## è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: [é“¾æ¥]
- æ–‡æ¡£: [é“¾æ¥]
- é—®é¢˜åé¦ˆ: [é“¾æ¥] 