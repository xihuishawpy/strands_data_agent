# ChatBI Gradio 前端界面

## 📖 简介

ChatBI Gradio前端提供了一个用户友好的Web界面，让您可以通过自然语言轻松查询数据库。界面包含以下核心功能：

## ✨ 主要功能

### 🔧 系统管理
- **数据库连接测试**: 验证数据库连接状态
- **Schema刷新**: 重新加载数据库结构信息
- **系统状态监控**: 实时显示系统运行状态

### 💬 智能查询
- **自然语言查询**: 用中文或英文描述您的数据需求
- **SQL自动生成**: AI自动将自然语言转换为SQL查询
- **查询执行**: 安全执行SQL并返回结果
- **查询历史**: 记录和展示历史查询

### 📊 数据展示
- **表格结果**: 清晰的表格格式展示查询数据
- **自动可视化**: 智能选择合适的图表类型
- **交互式图表**: 使用Plotly创建的交互式图表
- **数据分析**: AI对查询结果进行智能分析

### 🔍 查询解释
- **执行计划**: 查看SQL的执行计划
- **性能分析**: 了解查询的性能特征
- **SQL优化建议**: 获取查询优化建议

### 🗄️ Schema管理
- **数据库结构**: 查看完整的数据库结构
- **表信息**: 浏览表、字段、类型等详细信息
- **关系图**: 了解表之间的关系

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install gradio openai plotly pandas
```

### 2. 配置环境

确保您的 `.env` 文件包含正确的配置：

```env
# 数据库配置
DATABASE_TYPE=mysql
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_DATABASE=your_database
MYSQL_USER=your_username
MYSQL_PASSWORD=your_password

# DashScope API配置
DASHSCOPE_API_KEY=your_api_key
DASHSCOPE_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
```

### 3. 启动界面

```bash
# 方式1: 直接启动
python gradio_app.py

# 方式2: 使用启动脚本（推荐）
python start_gradio.py
```

### 4. 访问界面

打开浏览器访问: http://localhost:7860

## 💡 使用技巧

### 查询示例

#### 基础查询
```
显示所有用户
查看产品表的前10条记录
统计订单总数
```

#### 聚合查询
```
按地区统计销售总额
每个月的订单数量
平均订单金额是多少
```

#### 复杂查询
```
销售额最高的前10个客户
最近30天内的新注册用户
价格在100-500元之间的产品
```

#### 时间分析
```
今年的月度销售趋势
上个季度的业绩对比
本周每天的访问量
```

### 功能说明

#### 自动可视化
- 系统会根据数据类型自动选择合适的图表
- 支持柱状图、折线图、散点图、饼图等
- 可以关闭自动可视化功能

#### 分析级别
- **基础(basic)**: 提供基本的数据统计
- **标准(standard)**: 包含关键洞察和趋势分析
- **详细(detailed)**: 深入分析，包含异常检测和建议

#### 查询历史
- 自动记录所有查询
- 显示查询状态和结果行数
- 可以快速查看历史查询

## 🎨 界面特性

### 响应式设计
- 适配不同屏幕尺寸
- 清晰的布局和导航
- 直观的操作流程

### 实时反馈
- 即时显示查询状态
- 详细的错误信息
- 进度提示和状态更新

### 多标签页
- **SQL查询**: 显示生成的SQL语句
- **数据结果**: 表格形式展示查询结果
- **数据可视化**: 图表展示
- **智能分析**: AI分析结果

## 🔧 故障排除

### 常见问题

#### 1. 数据库连接失败
- 检查 `.env` 文件中的数据库配置
- 确保数据库服务正在运行
- 验证用户名、密码和权限

#### 2. API调用失败
- 确认 `DASHSCOPE_API_KEY` 是否正确
- 检查网络连接
- 验证API密钥是否有效

#### 3. 界面无法启动
- 确保已安装所有依赖包
- 检查端口7860是否被占用
- 查看终端错误信息

#### 4. 查询结果为空
- 确认数据库中有数据
- 检查查询条件是否正确
- 尝试更简单的查询

### 日志调试

启用调试模式查看详细日志：

```bash
export LOG_LEVEL=DEBUG
python gradio_app.py
```

## 🔐 安全注意事项

- 系统默认只执行 `SELECT` 查询，确保数据安全
- 不要在生产环境中暴露敏感的API密钥
- 建议在内网环境中使用
- 定期更新API密钥和数据库密码

## 📞 技术支持

如果您遇到问题或有改进建议，请：

1. 查看终端输出的错误信息
2. 检查 `logs/chatbi.log` 日志文件
3. 确认系统配置是否正确
4. 尝试重启应用

## 🎉 开始使用

现在您可以开始使用ChatBI Gradio界面了！

1. 首先测试数据库连接
2. 尝试一个简单的查询
3. 探索不同的功能
4. 体验AI驱动的数据分析

祝您使用愉快！🚀 